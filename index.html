<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV Database</title>
</head>
<body>
    <h1>CSV Database</h1>
    <center>
        <input type="text" id="searchInput" placeholder="Chanel name...">
        <button onclick="filter()">Filter</button>

        <!-- Input fields for XXX and YYY -->
        <label for="inputXXX">Username:</label>
        <input type="text" id="inputXXX" placeholder="Enter Username..." oninput="updateTable()">
        <label for="inputYYY">Password:</label>
        <input type="text" id="inputYYY" placeholder="Enter Password..." oninput="updateTable()">

        <!-- Button to fetch CSV from GitHub -->
        <button onclick="fetchCSVFromGitHub()">Fetch CSV from GitHub</button>
    </center>

    <div id="tableContainer">
        <table id="dataTable" style="display: none;"></table>
    </div>

    <script>
        var csvData = [];

        // Function to fetch CSV data from GitHub
        function fetchCSVFromGitHub() {
            fetch('https://raw.githubusercontent.com/Xebilon/Xebilon.github.io/main/Bok2.csv')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.text();
                })
                .then(csvText => {
                    csvData = csvText.split('\n').map(row => row.split(','));

                    // Convert CSV data to array of objects
                    csvData = csvData.slice(1).map(row => {
                        return {
                            Category: row[1],
                            ChannelName: row[2],
                            StreamURL: row[8]
                        };
                    });

                    // Populate table with rows as they are loaded
                    updateTable();
                })
                .catch(error => {
                    console.error('Error fetching CSV data:', error);
                });
        }

        // Function to update table
        function updateTable() {
            var inputXXX = document.getElementById('inputXXX').value;
            var inputYYY = document.getElementById('inputYYY').value;

            // Check if input values are not empty
            if (inputXXX.trim() !== '' && inputYYY.trim() !== '') {
                var tableHTML = '<tr><th>Category</th><th>Channel Name</th><th>Stream URL</th></tr>';
                var dataTable = document.getElementById('dataTable');
                csvData.forEach(row => {
                    var rowHTML = '<tr>';
                    rowHTML += '<td>' + row.Category + '</td>';
                    rowHTML += '<td>' + row.ChannelName + '</td>';

                    // Replace XXX and YYY in the Stream URL with user input values
                    var streamURL = row.StreamURL.replace('XXX', inputXXX);
                    streamURL = streamURL.replace('YYY', inputYYY);
                    rowHTML += '<td>' + streamURL + '</td>';

                    rowHTML += '</tr>';
                    tableHTML += rowHTML;
                });
                dataTable.innerHTML = tableHTML;
                
                // Show table
                dataTable.style.display = 'table'; // or 'block' if you prefer
            } else {
                // Clear the table if input values are empty
                document.getElementById('dataTable').innerHTML = '';
            }
        }

        // Function to filter data
        function filter() {
            var searchTerm = document.getElementById('searchInput').value.toLowerCase();
            var filteredData = csvData.filter(row => {
                // Check if the row has the 'Channel Name' property and if it includes the search term
                return row.ChannelName && row.ChannelName.toLowerCase().includes(searchTerm);
            });

            var tableHTML = '<tr><th>Category</th><th>Channel Name</th><th>Stream URL</th></tr>';
            for (var i = 0; i < filteredData.length; i++) {
                var row = filteredData[i];
                tableHTML += '<tr>';
                tableHTML += '<td>' + row.Category + '</td>';
                tableHTML += '<td>' + row.ChannelName + '</td>';

                // Replace XXX and YYY in the Stream URL with user input values
                var streamURL = row.StreamURL.replace('XXX', document.getElementById('inputXXX').value);
                streamURL = streamURL.replace('YYY', document.getElementById('inputYYY').value);
                tableHTML += '<td>' + streamURL + '</td>';

                tableHTML += '</tr>';
            }

            var dataTable = document.getElementById('dataTable');
            dataTable.innerHTML = tableHTML;
            dataTable.style.display = filteredData.length > 0 ? 'table' : 'none'; // Show table if data found, hide otherwise
        }

        // Fetch CSV data from GitHub when the page loads
        window.onload = fetchCSVFromGitHub;
    </script>
</body>
</html>
