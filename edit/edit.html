<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit HTML Layout</title>
    <style>
        #editor {
            border: 1px solid #ccc;
            min-height: 300px;
            padding: 20px;
            width: 100%;
            white-space: pre-wrap; /* Preserves line breaks */
        }

        button, select, input[type="color"] {
            margin-right: 10px;
        }

        .toolbar {
            margin-bottom: 10px;
        }

        /* Make sure dropdown is visible */
        select#tableDropdown {
            display: inline-block;
            width: auto;
            padding: 5px;
            margin: 5px 0;
        }

        /* Allow for proper centering */
        .center {
            text-align: center;
        }

        /* Fix hidden content to be visible */
        .hidden-content {
            display: block !important;  /* Override hidden styles */
        }

    </style>
</head>
<body>
    <h2>Edit Layout</h2>

    <!-- Toolbar with common document editing features and advanced styles -->
    <div class="toolbar">
        <!-- Basic Text Formatting -->
        <button onclick="execCmd('undo')">Undo</button>
        <button onclick="execCmd('bold')">Bold</button>
        <button onclick="execCmd('italic')">Italic</button>
        <button onclick="execCmd('underline')">Underline</button>
        <button onclick="execCmd('strikethrough')">Strikethrough</button>

        <!-- Text Alignment -->
        <button onclick="execCmd('justifyLeft')">Align Left</button>
        <button onclick="execCmd('justifyCenter')">Center</button>
        <button onclick="execCmd('justifyRight')">Align Right</button>

        <!-- Font and Size Selection -->
        <select onchange="execCmd('fontName', this.value)">
            <option value="Arial">Arial</option>
            <option value="Times New Roman">Times New Roman</option>
            <option value="Courier New">Courier New</option>
            <option value="Georgia">Georgia</option>
        </select>

        <select onchange="execCmd('fontSize', this.value)">
            <option value="1">Small</option>
            <option value="2">Medium</option>
            <option value="3" selected>Normal</option>
            <option value="4">Large</option>
            <option value="5">Very Large</option>
        </select>

        <!-- Text Color and Background Color -->
        <input type="color" onchange="execCmd('foreColor', this.value)" title="Text Color">
        <input type="color" onchange="execCmd('backColor', this.value)" title="Background Color">

        <!-- Insert Image -->
        <button onclick="insertImage()">Insert Image</button>

        <!-- Insert Table -->
        <button onclick="insertTable()">Insert Table</button>

        <!-- Insert Media -->
        <button onclick="insertMedia()">Insert Video</button>
    </div>

    <!-- Editable content area -->
    <div id="editor" contenteditable="true">
        <!-- Content will be injected here from index.html -->
    </div>

    <button onclick="saveChanges()">Save Changes</button>

    <script>
        // Function to execute commands like bold, italic, etc.
        function execCmd(command, value = null) {
            document.execCommand(command, false, value);
        }

        // Insert image into the editor
        function insertImage() {
            const url = prompt("Enter the image URL:");
            if (url) {
                document.execCommand('insertImage', false, url);
            }
        }

        // Insert a table into the editor
        function insertTable() {
            const rows = prompt("Enter number of rows:");
            const cols = prompt("Enter number of columns:");
            let tableHTML = '<table border="1">';
            for (let r = 0; r < rows; r++) {
                tableHTML += '<tr>';
                for (let c = 0; c < cols; c++) {
                    tableHTML += '<td>Cell</td>';
                }
                tableHTML += '</tr>';
            }
            tableHTML += '</table>';
            document.execCommand('insertHTML', false, tableHTML);
        }

        // Insert video (embed) into the editor
        function insertMedia() {
            const url = prompt("Enter the video URL (YouTube, Vimeo, etc.):");
            if (url) {
                const iframe = `<iframe width="560" height="315" src="${url}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
                document.execCommand('insertHTML', false, iframe);
            }
        }

        // Save changes to index.html
        function saveChanges() {
            const content = document.getElementById('editor').innerHTML;
            // Send content to the server (you can adapt this to your server-side logic)
            fetch('save.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ content: content })
            })
            .then(response => response.json())
            .then(data => alert('Changes saved successfully!'));
        }

        // Load the content of index.html into the editor
        function loadContent() {
            fetch('index.html')
                .then(response => response.text())
                .then(html => {
                    const editor = document.getElementById('editor');
                    editor.innerHTML = html;

                    // Fix hidden elements and dropdown visibility
                    const hiddenElements = editor.querySelectorAll('.hidden-content');
                    hiddenElements.forEach(element => {
                        element.style.display = 'block';  // Ensure hidden content is visible
                    });
                })
                .catch(error => console.error('Error loading content:', error));
        }

        // Initialize the layout and load content from index.html
        document.addEventListener('DOMContentLoaded', function() {
            loadContent(); // Load content from index.html into the editor
        });
    </script>
</body>
</html>
